
<!DOCTYPE html>
<html>
	<head>
		<script language="JavaScript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		<script language="JavaScript" src="//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
		<script language="JavaScript" src="scriptcam.js"></script>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script src="excellentexport.js"></script>

		<script> 
		
			$(document).ready(function() {
				$("#webcam").scriptcam({
					onError:onError,
					cornerRadius:0,
					onWebcamReady:onWebcamReady
				});
				
			});

			function onError(errorId,errorMsg) {
				alert(errorMsg);
			}			
			function changeCamera() {
				$.scriptcam.changeCamera($('#cameraNames').val());
			}
			function onWebcamReady(cameraNames,camera,microphoneNames,microphone,volume) {
				$.each(cameraNames, function(index, text) {
					$('#cameraNames').append( $('<option></option>').val(index).html(text) )
				}); 
				$('#cameraNames').val(camera);
				window.setInterval(function(){
				  decode();
				}, 1000);
			}
			
			function playasound() {
				$.scriptcam.playMP3("applause.mp3");
			}

			function decode() {
				var lastName = localStorage.getItem("lastname");
				var text = $.scriptcam.getBarCode();
				if (text !== lastName && text !== '')
				{
					localStorage.setItem("lastname", text);
					
					var decodedText = window.atob(text);
					var values = decodedText.split("##");
					$('#decoded2').text(window.atob(text));
					$("#myTable").find('tbody')
						.append($('<tr>')
							.append($('<td>')
									.text(values[0])
							)
							.append($('<td>')
									.text(values[1])
							)
							.append($('<td>')
									.text(values[2])
							)
							.append($('<td>')
									.text(values[3])
							)
							.append($('<td>')
									.text(values[4])
							)
						);
						playasound();
						
						//send email
						$.ajax({
						  type: "POST",
						  url: "https://mandrillapp.com/api/1.0/messages/send.json",
						  data: {
							'key': '1f-3rvWCpOs6mlsz3REAeg',
							'message': {
							  'from_email': 'no_reply@capgemini.com',
							  'to': [
								  {
									'email': values[1],
									'name': values[0],
									'type': 'to'
								  }
								],
							  'autotext': 'true',
							  'subject': 'Thanks for playing CapHun7',
							  'html': "&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;<br/>  &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;<br/>  &lt;title&gt;Capgemini Builders&lt;/title&gt;<br/>  <br/>&lt;script async=&quot;&quot; src=&quot;//www.google-analytics.com/analytics.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/js/jquery/jquery-1.8.3.js&quot;&gt;&lt;/script&gt;<br/>&lt;script type=&quot;text/javascript&quot; src=&quot;/js/jquery/jquery-ui-1.9.2.js&quot;&gt;&lt;/script&gt;<br/><br/><br/>        &lt;title&gt;&lt;/title&gt;        <br/>        &lt;link href=&quot;/css/global.css?v=1&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;<br/>&lt;link href=&quot;/css/autocomplete.css&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;<br/>&lt;link href=&quot;/css/jquery/jquery-ui.css&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;<br/>&lt;link href=&quot;/css/readonline.css&quot; media=&quot;screen&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;<br/>        <br/>        &lt;script type=&quot;text/javascript&quot; src=&quot;/js/template.js?v=11&quot;&gt;&lt;/script&gt;<br/>&lt;script type=&quot;text/javascript&quot; src=&quot;/js/assignallcommunication.js?v=2&quot;&gt;&lt;/script&gt;<br/>&lt;script type=&quot;text/javascript&quot; src=&quot;/js/message.js?v=1&quot;&gt;&lt;/script&gt;<br/>  <br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;script&gt;<br/>	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){<br/>	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),<br/>	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)<br/>	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');<br/>		ga('create', 'UA-41104915-3', 'capgemini.com');<br/>		ga('send', 'pageview');<br/><br/>&lt;/script&gt;<br/><br/><br/><br/>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;<br/>&lt;title&gt;CapHun7 thanks email&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {<br/>	background-image: none;<br/>	min-height: 690px;<br/>	margin-top: 0px;<br/>	background-color: #CCCCCC;<br/>	background-position: center top;<br/>    background-repeat: no-repeat;<br/>    border: none;<br/>    font-family:Arial;<br/>	font-size:12px;<br/>	color:#000000;    <br/>	background-color:#CCCCCC;<br/>	color:#000000;<br/>}<br/><br/>image {<br/>	border:none;<br/>}<br/><br/>p {<br/>	margin:0;<br/>	padding:0;<br/>}<br/><br/>a {<br/>	color:#1C49FF;<br/>}<br/><br/>a:visited {<br/>	color:#1C49FF;<br/>}<br/><br/>a:hover {<br/>	color:#1C49FF;<br/>}<br/><br/>a:active {<br/>	color:#1C49FF;<br/>}<br/><br/>h1,h2,h3,h4,h5,h6 {<br/>	color:#000000;<br/>}<br/><br/>.branding_logo {<br/>	margin-left:30px;<br/>	margin-right:30px;<br/>	padding-top:20px;<br/>	margin-bottom:20px;<br/>}<br/><br/>.articlehead_element {<br/>	font-size:16px;font-weight:bold;background:#FFFFFF;padding:0px;color:#000000;<br/>	width:690px;<br/>}<br/><br/>.container {<br/>	background:#FFFFFF;<br/>	width:750px;<br/>}<br/><br/>.comm_element {<br/>	margin-left:30px;<br/>	margin-right:30px;<br/>	width:690px;<br/>}<br/><br/>.question {<br/>	background: #ECF5FA;<br/>	margin-bottom: 10px;<br/>    padding: 10px;<br/>	font-size: 13px;<br/>	color:#000000;<br/>	<br/>	-webkit-border-radius: 5px;<br/>	-moz-border-radius: 5px;<br/>	border-radius: 5px;<br/>}<br/><br/>.required {<br/>	float: left;<br/>	margin-right: 5px;<br/>	color: red;<br/>}<br/>&lt;/style&gt;<br/><br/>&lt;a name=&quot;top&quot;&gt;&lt;/a&gt;&lt;!--CONTAINER-START--&gt;&lt;table class=&quot;container&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; align=&quot;center&quot; width=&quot;750px&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;!--BRANDING-LOGO-START--&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;margin-left:30px;margin-top:20px;&quot; width=&quot;100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;http://builders.capgemini.com/image/branding_logos/capgemini-logo-new.png?v=1?rnd=1&quot; width=&quot;681&quot; height=&quot;45&quot; alt=&quot;branding-logo&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;!--BRANDING-LOGO-END--&gt;<br/>&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;img src=&quot;http://builders.capgemini.com/upload/template_images/7CC7B50B-86B2-92F2-2A4F-61E6D9CD3113/user_banner/maze_header_email.jpg&quot; border=&quot;0&quot; width=&quot;750&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br/>&lt;!--##question_tags##--&gt;<br/>&lt;!--##NEW-ELEMENTS-SPACE-START##--&gt;&lt;!--MULTILINE-START--&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;comm_element&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;div class=&quot;no_question&quot; id=&quot;div_multiline_1&quot;&gt;&lt;p&gt;Dear Hunter,&lt;/p&gt;<br/><br/>&lt;p style=&quot;margin-left:35.4pt&quot;&gt;&amp;nbsp;&lt;/p&gt;<br/><br/>&lt;p&gt;Congratulations, you&#x2019;ve finished the CapHun7 game! The award ceremony will take place at 17.15 CET at the Capgemini stand, where the winners of the beacons will be announced.&lt;/p&gt;<br/><br/>&lt;p style=&quot;margin-left:35.4pt&quot;&gt;&amp;nbsp;&lt;/p&gt;<br/><br/>&lt;p&gt;Kind regards,&lt;br&gt;<br/>the CapHun7 team&lt;/p&gt;<br/>&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;!--MULTILINE-END--&gt;&lt;!--##NEW-ELEMENTS-SPACE-END##--&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;width:750px;background:#FFFFFF;&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;hr&gt;&lt;table width=&quot;100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style=&quot;font-size:12px;color:#000000;padding:30px;&quot;&gt;&lt;p align=&quot;center&quot;&gt;This message contains information that may be privileged or confidential and is the property of the Capgemini Group.&lt;br&gt; Copyright &#x00a9; 2015 Capgemini. All rights reserved.&lt;br&gt;&lt;br&gt;This message is intended only for the person to whom it is addressed. If you are not the intended recipient, you are not authorized to read, print, retain, copy, disseminate, distribute, or use this message or any part thereof. If you receive this message in error, please notify the sender immediately and delete all copies of this message.&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;!--CONTAINER-END--&gt;<br/><br/><br/><br/>&lt;/body&gt;&lt;/html&gt;"
							}
						  }
						 }).done(function(response) {
						   console.log(response); // if you're into that sorta thing
						 });
						 
								/* var link = "mailto:"+values[1]
									 //+ "?cc=andres.torres@capgemini.com"
									 + "&subject=" + escape("Thanks for playing CapHun7")
									 + "&body=" + escape("Thanks for playing CapHun7 with Capgemini")
							;

							window.location.href = link;*/
				}
			 }
		</script> 
	</head>
	<body>
		<div class="container">
			<div class="row">
				<div class="img-thumbnail" id="webcam">
				</div>
				<div>
					<img src="webcamlogo.png"/>
					<select id="cameraNames" size="1" onChange="changeCamera()" style="width:245px;font-size:10px;height:25px;">
					</select>
				</div>
			</div>
			<!--<div class="row">
				<p><button class="btn btn-small" id="btn1" onclick="$('#decoded').text($.scriptcam.getBarCode());">Decode image</button></p>
				<p id="decoded"></p>
			</div>
			<div class="row">
				<p><button class="btn btn-small" id="btn1" onclick="decode();">Decode text</button></p>

				<p id="decoded2">  </p>
			</div>-->
			<table id="myTable" class="table table-striped">
			<thead>
			  <tr>
				<th>Name</th>
				<th>Email</th>
				<th>Points</th>
				<th>Capgemini oportunities</th>
				<th>App Source Code</th>
			  </tr>
			  </thead>
			  <tbody>
			  </tbody>
			</table>
			
			<a download="playersData.xls" href="#" onclick="return ExcellentExport.excel(this, 'myTable', 'Sheet Name Here');">Export to Excel</a>

		</div>	
	</body>
	
</html>
